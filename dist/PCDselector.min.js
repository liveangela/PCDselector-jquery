var regionPicker={options:{jsonURL:"../json",opNames:[],opDoms:[],postcodeDom:"",cityVal:{},lastVal:{p:0,c:0,d:0,pHtml:"",cHtml:"",dHtml:""},defaultCode:[],defaultVal:[]},init:function(a){if(a instanceof Array&&3==a.length){this.options.opNames=a;for(var b=0;b<a.length;b++)this.options.opDoms.push($("#"+a[b]));this.options.lastVal.cHtml=this.options.opDoms[1].html(),this.options.lastVal.dHtml=this.options.opDoms[2].html(),this.defaultSet(),this.bind()}else console.error("PCDselector init failed: params need type array and count for 3")},renderOptions:function(a,b){var d,f,g,c="",e=this.options.defaultVal.length>0?1:0;for(f=0;f<a.length;f++)g="",d=a[f],e&&d.n==this.options.defaultVal[b]&&(g=' selected="selected"',this.options.defaultCode[b]=d.i),c+='<option value="'+d.n+'" data-i="'+d.i+'" data-z="'+d.z+'"'+g+">"+d.n+"</option>",d.c&&(this.options.cityVal[d.i]=d.c);return c},defaultSet:function(){var a=this;$.ajax({url:a.options.jsonURL+"/index.json",dataType:"json",success:function(b){a.options.opDoms[0].append(a.renderOptions(b,0)),a.options.defaultVal.length>0&&""!=a.options.defaultVal[0]&&""!=a.options.defaultVal[1]&&$.ajax({url:a.options.jsonURL+"/"+a.options.defaultCode[0]+".json",dataType:"json",success:function(b){if(a.options.opDoms[1].html(a.options.lastVal.cHtml+a.renderOptions(b,1)).removeAttr("disabled"),void 0!=a.options.defaultCode[1]){var c=a.options.cityVal&&a.options.cityVal[a.options.defaultCode[1]];c&&c.length>0&&a.options.opDoms[2].html(a.options.lastVal.dHtml+a.renderOptions(c,2)).removeAttr("disabled")}},error:function(a,b){console.log(b)}})},error:function(a,b){console.log(b),console.error("Request Province failed, please reload this page")}})},bind:function(){var a=this;$("#"+a.options.opNames.join(",#")).on("change",function(){var f,b=$(this),c=b.find("option:selected").attr("data-i")||0,d=b.find("option:selected").attr("data-z")||"",e=b.attr("id");0!=c?a.options.opNames[0]==e&&a.options.lastVal.p!=c?($.ajax({url:a.options.jsonURL+"/"+c+".json",dataType:"json",success:function(b){a.options.lastVal.p=c,a.options.opDoms[1].html(a.options.lastVal.cHtml+a.renderOptions(b,1)).removeAttr("disabled"),a.options.opDoms[2].html(a.options.lastVal.dHtml).attr("disabled","disabled")},error:function(a,b){console.log(b),console.error("Request Province failed, please reload this page")}}),a.options.postcodeDom.val("")):a.options.opNames[1]==e&&a.options.lastVal.c!=c?(f=a.options.cityVal&&a.options.cityVal[c],f&&f.length>0?(a.options.postcodeDom.val(""),a.options.opDoms[2].html(a.options.lastVal.dHtml+a.renderOptions(f,2)).removeAttr("disabled")):(a.options.opDoms[2].html(a.options.lastVal.dHtml).attr("disabled","disabled"),""!=a.options.postcodeDom&&a.options.postcodeDom.val(d))):a.options.opNames[2]==e&&a.options.lastVal.d!=c&&""!=a.options.postcodeDom&&a.options.postcodeDom.val(d):(a.options.postcodeDom.val(""),a.options.opNames[1]==e?a.options.opDoms[2].html(a.options.lastVal.dHtml).attr("disabled","disabled"):a.options.opNames[0]==e&&(a.options.opDoms[1].html(a.options.lastVal.cHtml).attr("disabled","disabled"),a.options.opDoms[2].html(a.options.lastVal.dHtml).attr("disabled","disabled")))})}};